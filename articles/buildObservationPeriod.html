<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Generating the Observation Period Table • OmopConstructor</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generating the Observation Period Table">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OmopConstructor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/buildObservationPeriod.html">Generating the Observation Period Table</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ohdsi/OmopConstructor/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generating the Observation Period Table</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ohdsi/OmopConstructor/blob/main/vignettes/buildObservationPeriod.Rmd" class="external-link"><code>vignettes/buildObservationPeriod.Rmd</code></a></small>
      <div class="d-none name"><code>buildObservationPeriod.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <a href="https://ohdsi.github.io/CommonDataModel/cdm54.html#observation_period" class="external-link"><code>observation_period</code></a>
table is a central component of the <a href="https://ohdsi.github.io/CommonDataModel/" class="external-link">OMOP CDM</a>.</p>
<p><em>The observation_period table contains records which define spans
of time during which two conditions are expected to hold: (i) Clinical
Events that happened to the Person are recorded in the Event tables, and
(ii) absence of records indicate such Events did not occur during this
span of time.</em></p>
<p>In practice, we summarise these two conditions by saying that a
person is in observation.</p>
<p>Accurately defining observation period is essential for many types of
studies. For example: in incidence or prevalence studies, it determines
the denominator population; in survival analyses, individuals are
censored once they are no longer in observation… The definition of
observation period can therefore strongly influence study results
[CITE].</p>
<p>For primary care or claims data, defining observation is relatively
straightforward, as it can be based on enrollment and disenrollment
dates. However, for datasets that only include secondary or tertiary
care records, it is more complex. In these cases, the <a href="https://heron-uk.github.io/heron-uk/" class="external-link">HERON-UK</a> network
recommends assigning a single observation period per person, starting
from their first record in the database (e.g., first hospital visit) and
ending at the earliest of: (1) the patient’s death date; (2) a censoring
age (commonly 120 years, but this may vary depending on the data
source); or (3) a censoring date (typically the data extraction date).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://heron-uk.github.io/heron-uk/data_conventions/observation_period.html" class="external-link uri"&gt;https://heron-uk.github.io/heron-uk/data_conventions/observation_period.html&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a></p>
<p>In this vignette, we will illustrate several approaches to defining
the observation period:</p>
<ol style="list-style-type: decimal">
<li>
<em>First to extraction</em>: one observation period per person from
first record to extraction date.</li>
<li>
<em>First to last</em>: one observation period per person from first
record to last record in the database.</li>
<li>
<em>Inpatient</em>: individuals are in observation while they have
an ongoing visit.</li>
<li>
<em>Collapse 180</em>: individuals are in observation while they
have an ongoing record, different records are collapsed using a window
of 180 days.</li>
<li>
<em>Collapse+Persistence 180</em>: individuals are in observation
while they have an ongoing record, different records are collapsed using
a window of 180 days, a persistence window of 179 days is added at the
end of each observation period.</li>
<li>
<em>Collapse+Persistence 365</em>: individuals are in observation
while they have an ongoing record, different records are collapsed using
a window of 365 days, a persistence window of 364 days is added at the
end of each observation period.</li>
<li>
<em>Pediatric</em>: one observation period per person from first
record to extraction date or 18th birthday of the individual.</li>
</ol>
<p>To demonstrate these definitions, we will use a toy example
containing 3 visit records (<code>visit_occurrence</code>) and 5 drug
records (<code>drug_exposure</code>). These are shown in Figure <span class="citation">@ref</span>(fig:fig-toy), where visits are shown in
blue and drug exposures in green.</p>
<div class="figure">
<img src="buildObservationPeriod_files/figure-html/fig-toy-1.png" alt="Representation of a synthetic patient records." width="700"><p class="caption">
Representation of a synthetic patient records.
</p>
</div>
<p>Now we can built our 7 definitions of the observation period as seen
in Figure <span class="citation">@ref</span>(fig:fig-obs). The inpatient
definition is the most restrictive one and 3 observation periods are
created one per each inpatient episode, on the other hand the ‘First to
extraction’ (1) and ‘Collapse+Persistence 365’ (6) are the one
generating a longer period of observed time. Note also that all
individuals observation period are censored at extraction date at the
latest.</p>
<div class="figure">
<img src="buildObservationPeriod_files/figure-html/fig-obs-1.png" alt="Different observation periods." width="700"><p class="caption">
Different observation periods.
</p>
</div>
<p>In the next section we will see how to built those observation
periods in a synthetic database.</p>
</div>
<div class="section level2">
<h2 id="build-observation_period-table-in-gibleed">Build observation_period table in GiBleed<a class="anchor" aria-label="anchor" href="#build-observation_period-table-in-gibleed"></a>
</h2>
<p>Now that we have seen the importance of the observation period
definition we will see how to built it in a synthetic dataset. For the
purpose of this example we will use the (<strong>GiBleed</strong>)
dataset available using <a href="https://ohdsi.github.io/omock/" class="external-link">omock</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ohdsi.github.io/omock/" class="external-link">omock</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ohdsi.github.io/OmopConstructor/" class="external-link">OmopConstructor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://OHDSI.github.io/OmopSketch/" class="external-link">OmopSketch</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/visOmopResults/" class="external-link">visOmopResults</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ohdsi.github.io/omock/reference/mockCdmFromDataset.html" class="external-link">mockCdmFromDataset</a></span><span class="op">(</span>datasetName <span class="op">=</span> <span class="st">"GiBleed"</span>, source <span class="op">=</span> <span class="st">"duckdb"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Reading <span style="color: #0000BB;">GiBleed</span> tables.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding <span style="color: #0000BB;">drug_strength</span> table.</span></span>
<span><span class="va">cdm</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;"># OMOP CDM reference (duckdb) of GiBleed</span> <span style="color: #00BBBB;">────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">omop tables:</span> care_site, cdm_source, concept, concept_ancestor, concept_class,</span></span>
<span><span class="co">#&gt; concept_relationship, concept_synonym, condition_era, condition_occurrence,</span></span>
<span><span class="co">#&gt; cost, death, device_exposure, domain, dose_era, drug_era, drug_exposure,</span></span>
<span><span class="co">#&gt; drug_strength, fact_relationship, location, measurement, metadata, note,</span></span>
<span><span class="co">#&gt; note_nlp, observation, observation_period, payer_plan_period, person,</span></span>
<span><span class="co">#&gt; procedure_occurrence, provider, relationship, source_to_concept_map, specimen,</span></span>
<span><span class="co">#&gt; visit_detail, visit_occurrence, vocabulary</span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">cohort tables:</span> -</span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">achilles tables:</span> -</span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">other tables:</span> -</span></span></code></pre></div>
<p>This dataset has the <code>observation_period</code> table already
populated, but we will create it again using the 7 definitions that we
have seen in the section above. Note the <code>cdm</code> is inserted in
a <a href="https://r.duckdb.org" class="external-link">duckdb</a> connection so we simulate
for a real case where we have the data in a database.</p>
<p>The <code>observation_period</code> table will be built using the <a href="https://ohdsi.github.io/OmopConstructor/reference/buildObservationPeriod.html" class="external-link"><code>buildObservationPeriod()</code></a>
function and we will parametrise it in different ways for each case.
Later we will summarise it using <a href="https://ohdsi.github.io/OmopSketch/" class="external-link">OmopSketch</a> so we can
compare the different definitions at the end.</p>
<p>For all the definitions of observation period we will use
<code>censorAge = 120</code> and
<code>dateRange = as.Date(c("1900-01-01", "2020-01-01"))</code>. Note
also that if a death record is in the database the person will
automatically be censored that day. Unless otherwise specified by
adjusting the <code>recordsFrom</code> argument, records contributing to
the observation period are searched for in the following tables:
<code>drug_exposure</code> and <code>visit_occurrence</code>.</p>
<div class="section level3">
<h3 id="first-to-extraction">First to extraction<a class="anchor" aria-label="anchor" href="#first-to-extraction"></a>
</h3>
<p>To build observation period that span from the first record to the
data extraction we will need to set the <code>collapseDays</code> and
<code>persistenceDays</code> to <code>Inf</code> as we want to span the
observation period till the extraction of data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildObservationPeriod.html">buildObservationPeriod</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  collapseDays <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  persistenceDays <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  censorAge <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  dateRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1900-01-01"</span>, <span class="st">"2020-01-01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summarise the generated observation_period using OmopSketch</span></span>
<span><span class="va">result1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseObservationPeriod.html" class="external-link">summariseObservationPeriod</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                       byOrdinal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">result1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseInObservation.html" class="external-link">summariseInObservation</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                   interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>                                   output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"person-days"</span>, <span class="st">"age"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:13:37.186721</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:13:37.274001</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:13:39.031062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:13:39.172051</span></span>
<span></span>
<span><span class="co"># change cdm_name to identify the different results objects</span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/bind.html" class="external-link">bind</a></span><span class="op">(</span><span class="va">result1a</span>, <span class="va">result1b</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cdm_name <span class="op">=</span> <span class="st">"First to extract"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="first-to-last">First to last<a class="anchor" aria-label="anchor" href="#first-to-last"></a>
</h3>
<p>To built observation period that span from the first record to the
last record extraction we will need to set the <code>collapseDays</code>
to <code>Inf</code> and <code>persistenceDays</code> to <code>0</code>
as we do not want to add any time after the last record. This
observation period definition can be problematic as observation periods
change retrospectively in each data extraction and toward the end of
observation you end up with a more sick population being in
observation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildObservationPeriod.html">buildObservationPeriod</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  collapseDays <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  persistenceDays <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  censorAge <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  dateRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1900-01-01"</span>, <span class="st">"2020-01-01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summarise the generated observation_period using OmopSketch</span></span>
<span><span class="va">result2a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseObservationPeriod.html" class="external-link">summariseObservationPeriod</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                       byOrdinal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">result2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseInObservation.html" class="external-link">summariseInObservation</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                   interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>                                   output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"person-days"</span>, <span class="st">"age"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:13:43.014273</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:13:43.107932</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:13:44.753803</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:13:44.883786</span></span>
<span></span>
<span><span class="co"># change cdm_name to identify the different results objects</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/bind.html" class="external-link">bind</a></span><span class="op">(</span><span class="va">result2a</span>, <span class="va">result2b</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cdm_name <span class="op">=</span> <span class="st">"First to last"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="inpatient">Inpatient<a class="anchor" aria-label="anchor" href="#inpatient"></a>
</h3>
<p>To built observation period for the inpatient episodes we will set
the <code>collapseDays</code> and <code>persistenceDays</code> to
<code>0</code> as we do not want to collapse or add any time after the
records. We will also have to specify that we only want to use data in
the <code>visit_occurrence</code> table, we will do that using the
<code>recordsFrom</code> argument
(<code>recordsFrom = visit_occurrence</code>). This would result in most
people having multiple observation periods, with each period duration
being relatively short. This is not a good option to use if you want to
calculate incidence or prevalence, as it will result in an unreliable
denominator.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildObservationPeriod.html">buildObservationPeriod</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  collapseDays <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  persistenceDays <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  censorAge <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  dateRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1900-01-01"</span>, <span class="st">"2020-01-01"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  recordsFrom <span class="op">=</span> <span class="st">"visit_occurrence"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `persistenceDays` (<span style="color: #0000BB;">0</span>) can not be equal to `collapseDays` (<span style="color: #0000BB;">0</span>) as back to back</span></span>
<span><span class="co">#&gt;   observation periods are not allowed, setting `collapseDays = <span style="color: #0000BB;">1</span>`.</span></span>
<span></span>
<span><span class="co"># summarise the generated observation_period using OmopSketch</span></span>
<span><span class="va">result3a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseObservationPeriod.html" class="external-link">summariseObservationPeriod</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                       byOrdinal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">result3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseInObservation.html" class="external-link">summariseInObservation</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                   interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>                                   output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"person-days"</span>, <span class="st">"age"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:13:48.875105</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:13:48.956658</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:13:50.282261</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:13:50.394297</span></span>
<span></span>
<span><span class="co"># change cdm_name to identify the different results objects</span></span>
<span><span class="va">result3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/bind.html" class="external-link">bind</a></span><span class="op">(</span><span class="va">result3a</span>, <span class="va">result3b</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cdm_name <span class="op">=</span> <span class="st">"Inpatient"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="collapse-180">Collapse 180<a class="anchor" aria-label="anchor" href="#collapse-180"></a>
</h3>
<p>To collapse records separated by 180 days we will use the
<code>collapseDays</code> argument (<code>collapseDays = 180</code>) and
set <code>persistenceDays</code> to <code>0</code> as we add any time
after the records.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildObservationPeriod.html">buildObservationPeriod</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  collapseDays <span class="op">=</span> <span class="fl">180</span>,</span>
<span>  persistenceDays <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  censorAge <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  dateRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1900-01-01"</span>, <span class="st">"2020-01-01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summarise the generated observation_period using OmopSketch</span></span>
<span><span class="va">result4a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseObservationPeriod.html" class="external-link">summariseObservationPeriod</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                       byOrdinal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">result4b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseInObservation.html" class="external-link">summariseInObservation</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                   interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>                                   output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"person-days"</span>, <span class="st">"age"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:13:54.744977</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:13:54.830476</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:13:56.40212</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:13:56.514404</span></span>
<span></span>
<span><span class="co"># change cdm_name to identify the different results objects</span></span>
<span><span class="va">result4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/bind.html" class="external-link">bind</a></span><span class="op">(</span><span class="va">result4a</span>, <span class="va">result4b</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cdm_name <span class="op">=</span> <span class="st">"Collapse 180"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="collapsepersistence-180">Collapse+Persistence 180<a class="anchor" aria-label="anchor" href="#collapsepersistence-180"></a>
</h3>
<p>To collapse records separated by 180 days we will use the
<code>collapseDays</code> argument (<code>collapseDays = 180</code>),
this time we will set <code>persistenceDays</code> to <code>179</code>
as we want to add 179 days after any record. Note
<code>persistenceDays</code> and <code>collapseDays</code> can not be
the same because <em>back to back</em> observation periods are not
allowed.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildObservationPeriod.html">buildObservationPeriod</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  collapseDays <span class="op">=</span> <span class="fl">180</span>,</span>
<span>  persistenceDays <span class="op">=</span> <span class="fl">179</span>,</span>
<span>  censorAge <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  dateRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1900-01-01"</span>, <span class="st">"2020-01-01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summarise the generated observation_period using OmopSketch</span></span>
<span><span class="va">result5a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseObservationPeriod.html" class="external-link">summariseObservationPeriod</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                       byOrdinal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">result5b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseInObservation.html" class="external-link">summariseInObservation</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                   interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>                                   output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"person-days"</span>, <span class="st">"age"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:14:00.920279</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:14:01.005507</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:14:02.621408</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:14:02.741194</span></span>
<span></span>
<span><span class="co"># change cdm_name to identify the different results objects</span></span>
<span><span class="va">result5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/bind.html" class="external-link">bind</a></span><span class="op">(</span><span class="va">result5a</span>, <span class="va">result5b</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cdm_name <span class="op">=</span> <span class="st">"Collapse+Persistence 180"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="collapsepersistence-365">Collapse+Persistence 365<a class="anchor" aria-label="anchor" href="#collapsepersistence-365"></a>
</h3>
<p>In this case we will set arguments to <code>365</code> and
<code>364</code> analogously to the previous definition.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildObservationPeriod.html">buildObservationPeriod</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  collapseDays <span class="op">=</span> <span class="fl">365</span>,</span>
<span>  persistenceDays <span class="op">=</span> <span class="fl">364</span>,</span>
<span>  censorAge <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  dateRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1900-01-01"</span>, <span class="st">"2020-01-01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summarise the generated observation_period using OmopSketch</span></span>
<span><span class="va">result6a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseObservationPeriod.html" class="external-link">summariseObservationPeriod</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                       byOrdinal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">result6b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseInObservation.html" class="external-link">summariseInObservation</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                   interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>                                   output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"person-days"</span>, <span class="st">"age"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:14:07.213416</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:14:07.297559</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:14:08.818659</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:14:08.934879</span></span>
<span></span>
<span><span class="co"># change cdm_name to identify the different results objects</span></span>
<span><span class="va">result6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/bind.html" class="external-link">bind</a></span><span class="op">(</span><span class="va">result6a</span>, <span class="va">result6b</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cdm_name <span class="op">=</span> <span class="st">"Collapse+Persistence 365"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pediatric">Pediatric<a class="anchor" aria-label="anchor" href="#pediatric"></a>
</h3>
<p>In this case we will use the same definition that we used for (First
to extraction) but we will set up the <code>censorAge</code> argument to
18 as we want to simulate a database with pediatric data where we loose
followup after the patient turns 18 as they are moved to other
specialised cares.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildObservationPeriod.html">buildObservationPeriod</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  collapseDays <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  persistenceDays <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  censorAge <span class="op">=</span> <span class="fl">18</span>,</span>
<span>  dateRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1900-01-01"</span>, <span class="st">"2020-01-01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summarise the generated observation_period using OmopSketch</span></span>
<span><span class="va">result7a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseObservationPeriod.html" class="external-link">summariseObservationPeriod</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                       byOrdinal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">result7b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/summariseInObservation.html" class="external-link">summariseInObservation</a></span><span class="op">(</span>observationPeriod <span class="op">=</span> <span class="va">cdm</span><span class="op">$</span><span class="va">observation_period</span>,</span>
<span>                                   interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>                                   output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"person-days"</span>, <span class="st">"age"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:14:12.437712</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:14:12.514194</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following estimates will be computed:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> age: median</span></span>
<span><span class="co">#&gt; → Start summary of data, at 2025-10-07 14:14:13.897656</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Summary finished, at 2025-10-07 14:14:14.001642</span></span>
<span></span>
<span><span class="co"># change cdm_name to identify the different results objects</span></span>
<span><span class="va">result7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/bind.html" class="external-link">bind</a></span><span class="op">(</span><span class="va">result7a</span>, <span class="va">result7b</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cdm_name <span class="op">=</span> <span class="st">"Pediatric"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparison-of-the-different-definitions">Comparison of the different definitions<a class="anchor" aria-label="anchor" href="#comparison-of-the-different-definitions"></a>
</h2>
<p>We can easily merge the different results into a single result object
using the <a href="https://darwin-eu.github.io/omopgenerics/reference/bind.summarised_result.html" class="external-link"><code>bind()</code></a>
function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/bind.html" class="external-link">bind</a></span><span class="op">(</span><span class="va">result1</span>, <span class="va">result2</span>, <span class="va">result3</span>, <span class="va">result4</span>, <span class="va">result5</span>, <span class="va">result6</span>, <span class="va">result7</span><span class="op">)</span></span></code></pre></div>
<p>If we compare the overall statistics of the observation period:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/tableObservationPeriod.html" class="external-link">tableObservationPeriod</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<div id="svbjzfxciq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#svbjzfxciq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#svbjzfxciq thead, #svbjzfxciq tbody, #svbjzfxciq tfoot, #svbjzfxciq tr, #svbjzfxciq td, #svbjzfxciq th {
  border-style: none;
}

#svbjzfxciq p {
  margin: 0;
  padding: 0;
}

#svbjzfxciq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #D9D9D9;
  border-right-style: solid;
  border-right-width: 3px;
  border-right-color: #D9D9D9;
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: #D9D9D9;
  border-left-style: solid;
  border-left-width: 3px;
  border-left-color: #D9D9D9;
}

#svbjzfxciq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#svbjzfxciq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#svbjzfxciq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#svbjzfxciq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#svbjzfxciq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#svbjzfxciq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#svbjzfxciq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#svbjzfxciq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#svbjzfxciq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#svbjzfxciq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#svbjzfxciq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#svbjzfxciq .gt_spanner_row {
  border-bottom-style: hidden;
}

#svbjzfxciq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#svbjzfxciq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#svbjzfxciq .gt_from_md > :first-child {
  margin-top: 0;
}

#svbjzfxciq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#svbjzfxciq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#svbjzfxciq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#svbjzfxciq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#svbjzfxciq .gt_row_group_first td {
  border-top-width: 2px;
}

#svbjzfxciq .gt_row_group_first th {
  border-top-width: 2px;
}

#svbjzfxciq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#svbjzfxciq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#svbjzfxciq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#svbjzfxciq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#svbjzfxciq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#svbjzfxciq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#svbjzfxciq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#svbjzfxciq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#svbjzfxciq .gt_table_body {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #D9D9D9;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#svbjzfxciq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#svbjzfxciq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#svbjzfxciq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#svbjzfxciq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#svbjzfxciq .gt_left {
  text-align: left;
}

#svbjzfxciq .gt_center {
  text-align: center;
}

#svbjzfxciq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#svbjzfxciq .gt_font_normal {
  font-weight: normal;
}

#svbjzfxciq .gt_font_bold {
  font-weight: bold;
}

#svbjzfxciq .gt_font_italic {
  font-style: italic;
}

#svbjzfxciq .gt_super {
  font-size: 65%;
}

#svbjzfxciq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#svbjzfxciq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#svbjzfxciq .gt_indent_1 {
  text-indent: 5px;
}

#svbjzfxciq .gt_indent_2 {
  text-indent: 10px;
}

#svbjzfxciq .gt_indent_3 {
  text-indent: 15px;
}

#svbjzfxciq .gt_indent_4 {
  text-indent: 20px;
}

#svbjzfxciq .gt_indent_5 {
  text-indent: 25px;
}

#svbjzfxciq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#svbjzfxciq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" style="text-align: center; font-weight: bold;" scope="col" id="Observation-period-ordinal">Observation period ordinal</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" style="text-align: center; font-weight: bold;" scope="col" id="Variable-name">Variable name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" style="text-align: center; font-weight: bold;" scope="col" id="Estimate-name">Estimate name</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="7" style="background-color: #D9D9D9; text-align: center; font-weight: bold;" scope="colgroup" id="spanner-[header_name]CDM name
[header_level]First to extract">
        <div class="gt_column_spanner">CDM name</div>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="background-color: #E1E1E1; text-align: center; font-weight: bold;" scope="col" id="[header_name]CDM-name-[header_level]First-to-extract">First to extract</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="background-color: #E1E1E1; text-align: center; font-weight: bold;" scope="col" id="[header_name]CDM-name-[header_level]First-to-last">First to last</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="background-color: #E1E1E1; text-align: center; font-weight: bold;" scope="col" id="[header_name]CDM-name-[header_level]Inpatient">Inpatient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="background-color: #E1E1E1; text-align: center; font-weight: bold;" scope="col" id="[header_name]CDM-name-[header_level]Collapse-180">Collapse 180</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="background-color: #E1E1E1; text-align: center; font-weight: bold;" scope="col" id="[header_name]CDM-name-[header_level]Collapse+Persistence-180">Collapse+Persistence 180</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="background-color: #E1E1E1; text-align: center; font-weight: bold;" scope="col" id="[header_name]CDM-name-[header_level]Collapse+Persistence-365">Collapse+Persistence 365</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="background-color: #E1E1E1; text-align: center; font-weight: bold;" scope="col" id="[header_name]CDM-name-[header_level]Pediatric">Pediatric</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="Observation period ordinal" class="gt_row gt_left" style="text-align: left;">all</td>
<td headers="Variable name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">Number records</td>
<td headers="Estimate name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">N</td>
<td headers="[header_name]CDM name
[header_level]First to extract" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">2,694</td>
<td headers="[header_name]CDM name
[header_level]First to last" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">2,694</td>
<td headers="[header_name]CDM name
[header_level]Inpatient" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">1,037</td>
<td headers="[header_name]CDM name
[header_level]Collapse 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">43,827</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">43,827</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 365" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">37,230</td>
<td headers="[header_name]CDM name
[header_level]Pediatric" class="gt_row gt_left" style="text-align: right;">2,691</td>
</tr>
<tr>
<td headers="Observation period ordinal" class="gt_row gt_left" style="text-align: left; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000;"></td>
<td headers="Variable name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">Number subjects</td>
<td headers="Estimate name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">N</td>
<td headers="[header_name]CDM name
[header_level]First to extract" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">2,694</td>
<td headers="[header_name]CDM name
[header_level]First to last" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">2,694</td>
<td headers="[header_name]CDM name
[header_level]Inpatient" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">890</td>
<td headers="[header_name]CDM name
[header_level]Collapse 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">2,694</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">2,694</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 365" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">2,694</td>
<td headers="[header_name]CDM name
[header_level]Pediatric" class="gt_row gt_left" style="text-align: right;">2,691</td>
</tr>
<tr>
<td headers="Observation period ordinal" class="gt_row gt_left" style="text-align: left; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000;"></td>
<td headers="Variable name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">Records per person</td>
<td headers="Estimate name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">mean (sd)</td>
<td headers="[header_name]CDM name
[header_level]First to extract" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">1.00 (0.00)</td>
<td headers="[header_name]CDM name
[header_level]First to last" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">1.00 (0.00)</td>
<td headers="[header_name]CDM name
[header_level]Inpatient" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">1.17 (0.41)</td>
<td headers="[header_name]CDM name
[header_level]Collapse 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">16.27 (3.55)</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">16.27 (3.55)</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 365" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">13.82 (3.17)</td>
<td headers="[header_name]CDM name
[header_level]Pediatric" class="gt_row gt_left" style="text-align: right;">1.00 (0.00)</td>
</tr>
<tr>
<td headers="Observation period ordinal" class="gt_row gt_left" style="text-align: left; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000;"></td>
<td headers="Variable name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;"></td>
<td headers="Estimate name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">median [Q25 - Q75]</td>
<td headers="[header_name]CDM name
[header_level]First to extract" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">1 [1 - 1]</td>
<td headers="[header_name]CDM name
[header_level]First to last" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">1 [1 - 1]</td>
<td headers="[header_name]CDM name
[header_level]Inpatient" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">1 [1 - 1]</td>
<td headers="[header_name]CDM name
[header_level]Collapse 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">16 [14 - 18]</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">16 [14 - 18]</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 365" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">14 [12 - 16]</td>
<td headers="[header_name]CDM name
[header_level]Pediatric" class="gt_row gt_left" style="text-align: right;">1 [1 - 1]</td>
</tr>
<tr>
<td headers="Observation period ordinal" class="gt_row gt_left" style="text-align: left; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000;"></td>
<td headers="Variable name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">Duration in days</td>
<td headers="Estimate name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">mean (sd)</td>
<td headers="[header_name]CDM name
[header_level]First to extract" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">22,113.65 (5,650.39)</td>
<td headers="[header_name]CDM name
[header_level]First to last" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">20,638.39 (5,163.38)</td>
<td headers="[header_name]CDM name
[header_level]Inpatient" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">2.26 (0.72)</td>
<td headers="[header_name]CDM name
[header_level]Collapse 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">64.24 (369.09)</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">243.24 (369.09)</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 365" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">486.42 (445.34)</td>
<td headers="[header_name]CDM name
[header_level]Pediatric" class="gt_row gt_left" style="text-align: right;">6,259.75 (555.77)</td>
</tr>
<tr>
<td headers="Observation period ordinal" class="gt_row gt_left" style="text-align: left; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000;"></td>
<td headers="Variable name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;"></td>
<td headers="Estimate name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">median [Q25 - Q75]</td>
<td headers="[header_name]CDM name
[header_level]First to extract" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">21,372 [17,929 - 24,705]</td>
<td headers="[header_name]CDM name
[header_level]First to last" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">19,332 [16,404 - 23,663]</td>
<td headers="[header_name]CDM name
[header_level]Inpatient" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">2 [2 - 2]</td>
<td headers="[header_name]CDM name
[header_level]Collapse 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">15 [1 - 31]</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">194 [180 - 210]</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 365" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">379 [365 - 473]</td>
<td headers="[header_name]CDM name
[header_level]Pediatric" class="gt_row gt_left" style="text-align: right;">6,476 [6,305 - 6,477]</td>
</tr>
<tr>
<td headers="Observation period ordinal" class="gt_row gt_left" style="text-align: left; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000;"></td>
<td headers="Variable name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">Days to next observation period</td>
<td headers="Estimate name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">mean (sd)</td>
<td headers="[header_name]CDM name
[header_level]First to extract" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">-</td>
<td headers="[header_name]CDM name
[header_level]First to last" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">-</td>
<td headers="[header_name]CDM name
[header_level]Inpatient" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">8,254.63 (6,124.99)</td>
<td headers="[header_name]CDM name
[header_level]Collapse 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">1,284.26 (1,193.62)</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">1,105.26 (1,193.62)</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 365" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">1,113.77 (1,209.43)</td>
<td headers="[header_name]CDM name
[header_level]Pediatric" class="gt_row gt_left" style="text-align: right;">-</td>
</tr>
<tr>
<td headers="Observation period ordinal" class="gt_row gt_left" style="text-align: left; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000;"></td>
<td headers="Variable name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: hidden; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;"></td>
<td headers="Estimate name" class="gt_row gt_left" style="text-align: left; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">median [Q25 - Q75]</td>
<td headers="[header_name]CDM name
[header_level]First to extract" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">-</td>
<td headers="[header_name]CDM name
[header_level]First to last" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">-</td>
<td headers="[header_name]CDM name
[header_level]Inpatient" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">6,531 [3,540 - 12,747]</td>
<td headers="[header_name]CDM name
[header_level]Collapse 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">883 [444 - 1,706]</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 180" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">704 [265 - 1,527]</td>
<td headers="[header_name]CDM name
[header_level]Collapse+Persistence 365" class="gt_row gt_left" style="text-align: right; border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; border-top-width: 1px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #D3D3D3;">733 [298 - 1,535]</td>
<td headers="[header_name]CDM name
[header_level]Pediatric" class="gt_row gt_left" style="text-align: right;">-</td>
</tr>
</tbody>
</table>
</div>
<p>We can see that definitions (1), (2) and (7) lead to a one
observation period per person by definition. The Collapse 180 (4) and
Collapse+Persistence180 (5) lead to the same number of observation
periods but with different durations. We can take a better look to this
statistics looking at the plots:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/plotObservationPeriod.html" class="external-link">plotObservationPeriod</a></span><span class="op">(</span>result <span class="op">=</span> <span class="va">result</span>, </span>
<span>                      variableName <span class="op">=</span> <span class="st">"Records per person"</span>,</span>
<span>                      plotType <span class="op">=</span> <span class="st">"densityplot"</span>, </span>
<span>                      colour <span class="op">=</span> <span class="st">"cdm_name"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="buildObservationPeriod_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>As expected for example we can see that using a window of 180 creates
more observation periods that using the 365 collapse window, this is
expected, the bigger the window the less observation periods we will
have.</p>
<p>Now taking a look at the length of the observation periods, to make
the plot more clear we will renomalise to a maximum of 1 so we can see
the different densities side by side:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/filterSettings.html" class="external-link">filterSettings</a></span><span class="op">(</span><span class="va">result_type</span> <span class="op">==</span> <span class="st">"summarise_observation_period"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">variable_name</span> <span class="op">==</span> <span class="st">"Duration in days"</span>,</span>
<span>    <span class="va">estimate_name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"density_x"</span>, <span class="st">"density_y"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cdm_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cdm_name</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cdm_name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cdm_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>density_y <span class="op">=</span> <span class="va">density_y</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">density_y</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://darwin-eu.github.io/visOmopResults/reference/scatterPlot.html" class="external-link">scatterPlot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"density_x"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"density_y"</span>,</span>
<span>    line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    point <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    ribbon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"cdm_name"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="buildObservationPeriod_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>As we can see the Collapse, persistent and Inpatient approaches
generate short observation periods, in the pediatric approach most of
the individuals are censored at their 18th birth day and as in
<strong>GiBleed</strong> we have many individuals contributing since
their birth date we have a peak at ~6574 days. ‘First to extract’ and
‘First to last’ show similar time distributions with higher times for
the ‘First to extract’ approach.</p>
<p>Now we can compare the amount of person-days in observation for each
one of the observation period definitions, note this would be the
denominator of an incidence or prevalence study.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op">==</span> <span class="st">'Number person-days'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/plotInObservation.html" class="external-link">plotInObservation</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"cdm_name"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `result_id` is not present in <span style="color: #0000BB;">result</span>.</span></span>
<span><span class="co">#&gt; `result_id` is not present in <span style="color: #0000BB;">result</span>.</span></span></code></pre></div>
<p><img src="buildObservationPeriod_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>In this plot there are some trends worth remarking:</p>
<ul>
<li><p>A larger gap increases the observation time (green vs
yellow)</p></li>
<li><p>Adding a persistence window increases quite a bit the observable
time (red vs green)</p></li>
<li><p>Using the first to last approach lead to less individuals being
in observation towards the end of the observation window.</p></li>
</ul>
<p>Finally, to show more in depth the findings we can see the evolution
of the median age of the individuals in observation:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op">==</span> <span class="st">'Median age in observation'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://OHDSI.github.io/OmopSketch/reference/plotInObservation.html" class="external-link">plotInObservation</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"cdm_name"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `result_id` is not present in <span style="color: #0000BB;">result</span>.</span></span>
<span><span class="co">#&gt; `result_id` is not present in <span style="color: #0000BB;">result</span>.</span></span></code></pre></div>
<p><img src="buildObservationPeriod_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>In this case we see that the pediatric population always has a lower
median age as individuals are censored when they turn 18. Due to
<strong>GiBleed</strong> nature we do not see other trends that we see
in real world data like older population in observation the lower the
collapse window is, sicker and older population for the inpatient
definition, or sicker population at the closer you get to the extraction
date for the ‘First to last’ definition.</p>
<p>TODO: Add citation to the observation period methods paper when
ready. TODO: Invite collaborators to submit their results and have a
shiny with the comparison and impact of the decision in different
datasets.</p>
</div>
<div class="section level2">
<h2 id="final-remarks">Final remarks<a class="anchor" aria-label="anchor" href="#final-remarks"></a>
</h2>
<p>As seen, the observation period table is key and has a significant
impact on many studies. Therefore, defining the observation period must
be done carefully, with full awareness of the limitations associated
with each approach. The most appropriate observation period often varies
from study to study. This is where <strong>OmopConstructor</strong>
becomes especially valuable, as it allows users to define custom
observation periods on a study-by-study basis.</p>
<blockquote>
<p><strong>Note:</strong> For database back-end cdms note the
<code>observation_period</code> table is generated in the
<code>writeSchema</code>. If you want to use it to generate the
<code>observation_period</code> in the <code>cdmSchema</code> you will
need to use the <code>writeSchema = cdmSchema</code> and have writing
permissions in the <code>cdmSchema</code>.</p>
</blockquote>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martí Català.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
